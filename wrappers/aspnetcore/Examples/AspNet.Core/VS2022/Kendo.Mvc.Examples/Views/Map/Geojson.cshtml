@(Html.Kendo().Map()
      .Name("map")
      .Center(30.2681, -97.7448)
      .Zoom(3)
      .Layers(layers =>
       {
           layers.Add()
              .Style(style => style.Fill(fill => fill.Opacity(0.7)))
              .Type(MapLayerType.Shape)
              .DataSource(dataSource => dataSource
                  .GeoJson()
                  .Read(read => read.Url(Url.Content("~/shared/dataviz/map/countries-users.geo.json")))
              );
       })
       .Events(events => events
           .ShapeCreated("onShapeCreated")
           .ShapeFeatureCreated("onShapeFeatureCreated")
           .ShapeMouseEnter("onShapeMouseEnter")
           .ShapeMouseLeave("onShapeMouseLeave")
        )
)

@section scripts{
    <!-- Chroma.js used to colorize the map in the demo -->
    <script data-src=@Url.Content("~/shared/dataviz/map/js/chroma.min.js")></script>

    <script>
        var scale;
        $(document).on("kendoReady", function () {
            scale = chroma
                .scale(["white", "green"])
                .domain([1, 1000]);
        });

        function onShapeCreated(e) {
            var shape = e.shape;
            var users = shape.dataItem.properties.users;
            if (users) {
                var color = scale(users).hex();
                shape.options.fill.set("color", color);
            }
        }

        function onShapeFeatureCreated(e) {
            e.group.options.tooltip = {
                content: e.properties.name,
                position: "cursor",
                offset: 10,
                width: 80
            };
        }

        function onShapeMouseEnter(e) {
            e.shape.options.set("fill.opacity", 1);
        }

        function onShapeMouseLeave(e) {
            e.shape.options.set("fill.opacity", 0.7);
        }
    </script>
}